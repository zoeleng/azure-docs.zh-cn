---
title: 排查 Azure 中共享映像的问题
description: 了解如何排查共享映像库问题。
author: olayemio
ms.service: virtual-machines
ms.subservice: imaging
ms.topic: troubleshooting
ms.workload: infrastructure
ms.date: 10/27/2020
ms.author: olayemio
ms.reviewer: cynthn
ms.openlocfilehash: b77132a12475a66c099f5d38c04e8b58f7b839a7
ms.sourcegitcommit: 4bee52a3601b226cfc4e6eac71c1cb3b4b0eafe2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/11/2020
ms.locfileid: "94504843"
---
# <a name="troubleshoot-shared-image-galleries-in-azure"></a>排查 Azure 中的共享映像库问题

如果对共享映像库、映像定义和映像版本执行任何操作时遇到问题，请在调试模式下再次运行失败的命令。 通过 `--debug` 将开关与 Azure CLI 和交换机一起传递到 PowerShell 来激活调试模式 `-Debug` 。 找到错误后，请按照本文中的步骤进行故障排除。


## <a name="creating-or-modifying-a-gallery"></a>创建或修改库 ##

*库名称无效。允许的字符为英文字母数字字符、下划线和中间允许的句点，最多80个字符。不允许其他所有特殊字符（包括短划线）。*  
**原因** ：库的名称不符合命名要求。  
**解决方法** ：选择满足以下条件的名称： 
- 的限制为80个字符
- 只包含英文字母、数字、下划线和句点
- 以英文字母或数字开头和结尾

*根据其验证规则，实体名称 "galleryName" 无效： ^ [^ \_ \w] [\w-. \_ ] {0,79} (？ <！ [-.]) $。*  
**原因** ：库名称不满足命名要求。  
**解决方法** ：选择满足以下条件的库的名称： 
- 的限制为80个字符
- 只包含英文字母、数字、下划线和句点
- 以英文字母或数字开头和结尾

*提供的资源名称 <galleryName \> 具有以下无效的尾随字符： <字符 \> 。名称不能以字符结尾： <字符\>*  
**原因** ：库的名称以句点或下划线结束。  
**解决方法** ：选择满足以下条件的库的名称： 
- 的限制为80个字符
- 只包含英文字母、数字、下划线和句点
- 以英文字母或数字开头和结尾

*提供的位置 <区域不可 \> 用于资源类型 "Microsoft. 计算/库"。资源类型的可用区域列表为 .。。*  
**原因** ：为库指定的区域不正确或需要访问请求。  
**解决方法** ：检查区域名称拼写是否正确。 您可以运行此命令来查看您有权访问哪些区域。 如果该区域不在列表中，则提交 [访问请求](/troubleshoot/azure/general/region-access-request-process)。

*删除嵌套资源前无法删除资源。*  
**原因** ：你已尝试删除至少包含一个现有映像定义的库。 库必须为空，然后才能删除它。  
**解决方法** ：删除库中的所有映像定义，然后继续删除库。 如果映像定义包含映像版本，则必须先删除映像版本，然后才能删除图像定义。

*资源 \> \_ \> 组 <resourceGroup 中 <区域1的位置中已存在资源 <galleryName \> 。无法在区域 2 <位置创建具有相同名称的资源 \_ \> 。请选择新的资源名称。*  
**原因** ：资源组中已存在具有相同名称的现有库，并且已尝试使用同一名称创建另一个具有相同名称的库。  
**解决方法** ：使用不同的库或使用其他资源组。

## <a name="creating-or-modifying-image-definitions"></a>创建或修改映像定义 ##

*不允许更改属性 "galleryImage" <属性 \> "。*  
**原因** ：您尝试更改操作系统类型、os 状态、hyper-v 生成、产品/服务、发布者或 SKU。 不允许更改这些属性中的任何一个。  
**解决方法** ：改为创建新的映像定义。

*资源 \> \_ \> 组 <resourceGroup 中 <区域1的位置中已存在资源 <galleryName/imageDefinitionName \> 。无法在区域 2 <位置创建具有相同名称的资源 \_ \> 。请选择新的资源名称。*  
**原因** ：具有相同名称的同一库和资源组中存在现有的映像定义。 您尝试在同一库中创建另一个具有相同名称和不同区域的图像定义。  
**解决方法** ：对映像定义使用不同的名称，或将映像定义放在不同的库或资源组中。

*提供的资源名称 <galleryName \> /<imageDefinitionName \> 具有以下无效的尾随字符： <字符 \> 。名称不能以字符结尾： <字符\>*  
**原因** ： <imageDefinitionName \> 名称以句点或下划线结尾。  
**解决方法** ：选择满足以下条件的映像定义的名称： 
- 的限制为80个字符
- 只包含英文字母、数字、下划线和句点
- 以英文字母或数字开头和结尾。

*根据 imageDefinitionName 的验证规则，实体名称 <\> 无效： ^ [^ \_ \\ W] [ \\ w-. \_ ] {0,79} (？ <！ [-.]) $ "*  
**原因** ： <imageDefinitionName \> 名称以句点或下划线结尾。  
**解决方法** ：选择满足以下条件的映像定义的名称： 
- 的限制为80个字符
- 只包含英文字母、数字、下划线和句点
- 以英文字母或数字开头和结尾

*资产名称 galleryImage <属性 \> 无效。它不能为空。允许的字符为大写或小写字母、数字、连字符 ( ) 、句点 ( ) 、下划线 (\_) 。不允许名称以句点 ( 结尾。 ) 。名称长度不能超过 <数字 \> 字符。*  
**原因** ：发布者、产品/服务或 SKU 值不满足命名要求。  
**解决方法** ：选择满足以下条件的值： 
- 对于产品/服务和 SKU，超过128个字符64的限制
- 只包含英文字母、数字、连字符、下划线和句点
- 不以句点结尾

*不能对嵌套资源执行请求的操作。找不到父资源 <galleryName \> 。*  
**原因** ： \> 当前订阅和资源组中没有名为 <galleryName 的库。  
**解决方法** ：检查库、订阅和资源组的名称是否正确。 否则，请创建名为 <galleryName 的新库 \> 。

*提供的位置 <区域不可 \> 用于资源类型 "Microsoft. 计算/库"。资源类型的可用区域列表为 .。。*  
**原因** ： <区域 \> 名称不正确或需要访问请求。  
**解决方法** ：检查区域名称拼写是否正确。 您可以运行此命令来查看您有权访问哪些区域。 如果该区域不在列表中，则提交 [访问请求](/troubleshoot/azure/general/region-access-request-process)。

*无法序列化值： <\> 类型为 "iso-8601" 的值。，ISO8601Error： iso 8601 时间指示器 "t" 缺失。无法分析日期时间字符串 <值\>*  
**原因** ：为属性提供的值的格式不正确。  
**解决方法** ：提供 yyyy-dd，YYYY-Mm-dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)格式有效的日期。

*无法将字符串转换为 DateTimeOffset： <值 \> 。路径 "properties. <属性 \> "*  
**原因** ：为属性提供的值的格式不正确。  
**解决方法** ：提供 yyyy-dd，YYYY-Mm-dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)格式有效的日期。

*EndOfLifeDate 必须设置为将来的日期。*  
**原因** ：生存时间结束日期属性的格式不正确，不能作为当天日期之后的日期格式。  
**解决方法** ：提供 yyyy-dd，YYYY-Mm-dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)格式有效的日期。

*参数--<属性 \> ：整数值无效： <值\>*  
**原因** ： <属性 \> 仅接受整数值，并且 <值 \> 不是整数。  
**解决方法** ：选择一个整数值。

*<属性的最小值 \> 不得大于 <属性的最大值 \> 。*  
**原因** ：为 <属性提供的最小值 \> 高于为 <属性提供的最大值 \> 。  
**解决方法** ：更改值，使最小值小于或等于最大值。

*库图像： \> (publisher <imageDefinitionName 标识： <发布者 \> 、产品/服务： <产品/服务 \> 、SKU： <sku \>) 已经存在。选择其他发布者、产品/服务、sku 组合。*  
**原因** ：你已尝试使用相同的发布者、产品/服务和 SKU 以相同库中的现有映像定义来创建新的映像定义。  
**解决方法** ：在库中，所有图像定义必须具有发布者、产品/服务和 SKU 的唯一组合。 选择一个唯一的组合，或选择一个新的库，然后重新创建映像定义。

*删除嵌套资源前无法删除资源。*  
**原因** ：你已尝试删除包含映像版本的映像定义。 映像定义必须为空，然后才能删除它。  
**解决方法** ：删除映像定义中的所有映像版本，然后继续删除映像定义。

*无法绑定参数 <属性 \> 。无法将值 <值转换 \> 为类型 <propertyType \> 。无法将标识符名称 <值与 \> 有效的枚举器名称匹配。指定以下枚举器名称之一，然后重试： <choice1 \> 、<choice2 \> .。。*  
**原因** ：属性具有受限制的可能值的列表，并且 <值 \> 不是其中之一。  
**解决方法** ：选择可能的 <选项 \> 值之一。

*无法绑定参数 <属性 \> 。无法将值 <值转换 \> 为类型 &quot; system.object&quot;*  
**原因** ：为属性提供的值的格式不正确。  
**解决方法** ：提供 yyyy-dd，YYYY-Mm-dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)格式有效的日期。

*无法绑定参数 <属性 \> 。无法将值 <值转换 \> 为类型 &quot; system.object&quot;*  
**原因** ： <属性 \> 仅接受整数值，并且 <值 \> 不是整数。  
**解决方法** ：选择一个整数值。

*此区域不支持 ZRS 存储帐户类型。*  
**原因** ：已在尚不支持 ZRS) 的区域中选择了标准区域冗余存储 (。  
**解决方法** ：将存储帐户类型更改为 **Premium \_ LRS** 或 **Standard \_ LRS** 。 查看文档以了解已启用 ZRS 预览版的最新 [区域列表](/azure/storage/common/storage-redundancy#zone-redundant-storage) 。

## <a name="creating-or-updating-image-versions"></a>创建或更新映像版本 ##

*提供的位置 <区域不可 \> 用于资源类型 "Microsoft. 计算/库"。资源类型的可用区域列表为 .。。*  
**原因** ： <区域 \> 名称不正确或需要访问请求。  
**解决方法** ：检查区域名称拼写是否正确。 您可以运行此命令来查看您有权访问哪些区域。 如果该区域不在列表中，则提交 [访问请求](/troubleshoot/azure/general/region-access-request-process)。

*不能对嵌套资源执行请求的操作。找不到父资源 <galleryName/imageDefinitionName \> 。*  
**原因** ： \> 当前订阅和资源组中没有名为 <galleryName/imageDefinitionName 的库。  
**解决方法** ：检查库、订阅和资源组的名称是否正确。 否则，请在指定的资源组中创建一个名为 <galleryName \> 和/或名为 <imageDefinitionName 的映像定义的新库 \> 。

*无法绑定参数 <属性 \> 。无法将值 <值转换 \> 为类型 &quot; system.object&quot;*  
**原因** ：为属性提供的值的格式不正确。  
**解决方法** ：提供 yyyy-dd，YYYY-Mm-dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)格式有效的日期。

*无法绑定参数 <属性 \> 。无法将值 <值转换 \> 为类型 &quot; system.object&quot;*  
**原因** ： <属性 \> 仅接受整数值，并且 <值 \> 不是整数。  
**解决方法** ：选择一个整数值。

*库映像版本发布配置文件区域 <publishingRegions \> 必须包含映像版本 <sourceRegion 的位置\>*  
**原因** ： \> <publishingRegions 列表中必须包含源映像 ( # B0 sourceRegion) 的位置 \> 。  
**解决方法** ： \> <publishingRegions 列表中包括 <sourceRegion \> 。

*\>参数 <属性 <值 \> 超出了范围。该值必须介于 <minValue \> 和 <个 \> （含）之间。*  
**原因** ： <值 \> 超出了 <属性的可能值的范围 \> 。  
**解决方法** ：选择一个介于 <minValue \> 和 <个（含）范围内的值 \> 。

*\>找不到源 <resourceID。请检查源是否存在，并与要创建的库映像版本位于同一区域。*  
**原因** ： <resourceID 上没有源 \> ，或者 <resourceID 与 \> 正在创建的库映像不在同一区域中。  
**解决方法** ：检查 <resourceid \> 值是否正确，以及库图像版本的源区域是否与 <resourceID 值的区域相同 \> 。

*不允许更改属性 "<galleryImageVersion diskImage \> source.id"。*  
**原因** ：在创建库映像版本后，无法更改其源 ID。  
**解决方法** ：请确保源 id 与现有源 id 相同，更改映像版本的版本号，或删除当前映像版本，然后重试。

*在输入数据磁盘中检测到重复的 lun 编号。Lun 编号对于每个数据磁盘必须是唯一的。*  
**原因** ：使用磁盘和/或磁盘快照列表创建映像版本时，两个或更多磁盘或磁盘快照具有相同的 LUN。  
**解决方法** ：删除或更改任何重复的 lun。

*在输入磁盘中找到重复的源 id。每个磁盘的源 id 应该是唯一的。*  
**原因** ：使用磁盘和/或磁盘快照列表创建映像版本时，两个或更多磁盘或磁盘快照具有相同的资源 ID。  
**解决方法** ：删除或更改任何重复的磁盘源 id。

*\>位于路径 "storageProfile. <source.id" 的 resourceID <的属性 id \> 无效。需要以 "/subscriptions/{subscriptionId}" 或 "/providers/{resourceProviderNamespace}/" 开头的完全限定的资源 Id。*  
**原因** ： <resourceID \> 值的格式不正确。  
**解决方法** ：检查资源 ID 是否正确。

*源 id： <resourceID \> 必须是托管映像、虚拟机或其他库映像版本*  
**原因** ： <resourceID \> 值的格式不正确。  
**解决方法** ：如果使用 vm、托管映像或库映像版本作为源映像，请检查 VM 的资源 ID、托管映像或库映像版本是否正确。

*源 id： <resourceID \> 必须是托管磁盘或快照。*  
**原因** ： <resourceID \> 值的格式不正确。  
**解决方法** ：如果使用磁盘和/或磁盘快照作为映像版本的源，请检查磁盘和/或磁盘快照的资源 id 是否正确。

*无法从以下项创建库映像版本： <resourceID， \> 因为父库映像中的 OS 状态 ( # B1 OsState \_ 1 \>) 不 <OsState \_ 2 \> 。*  
**原因** ： (通用化或专用) 的操作系统状态与映像定义中指定的操作系统状态不匹配。  
**解决方法** ：选择基于虚拟机的源 <OsState 1 的操作系统状态， \_ \> 或基于 <OsState 2 为 vm 创建新的映像定义 \_ \> 。

*Id 为 "<resourceID" 的资源 \> 具有不同的虚拟机监控程序生成 ["<V # \_ 1 \> "]，而不是父库映像虚拟机监控程序生成 ["<V # \_ 2 \> "]*  
**原因** ：映像版本的虚拟机监控程序生成与映像定义中指定的虚拟机监控程序生成不匹配。 映像定义操作系统为 <V # \_ 1 \> ，映像版本操作系统 <v # \_ 2 \> 。  
**解决方法** ：选择与映像定义具有相同的虚拟机监控程序生成的源，或创建/选择与映像版本具有相同的虚拟机监控程序生成的新映像定义。

*Id 为 "<resourceID" 的资源 \> 具有不同的 os 类型 ["<OsType \_ 1 \> "]，而不是父库映像操作系统类型生成 ["<OsType \_ 2 \> "]*  
**原因** ：映像版本的虚拟机监控程序生成与映像定义中指定的虚拟机监控程序生成不匹配。 映像定义操作系统为 <OsType \_ 1 \> ，映像版本操作系统 <OsType \_ 2 \> 。  
**解决方法** ：选择具有相同操作系统 (Linux/Windows) 的源作为映像定义，或创建/选择与映像版本具有相同操作系统生成的新映像定义。

*<resourceID 的源虚拟机 \> 不能包含临时 OS 磁盘。*  
**原因** ：位于 <resourceID 的源 \> 包含一个临时 OS 磁盘。 共享映像库当前不支持临时 OS 磁盘。  
**解决方法** ：根据不使用临时 OS 磁盘的 VM 选择不同的源。

*<resourceID 的源虚拟机 \> 不能包含 \> UltraSSD 帐户类型中存储的磁盘 ["<diskID"]。*  
**原因** ：磁盘 <diskID \> 是超级 SSD 磁盘。 共享映像库当前不支持超级 SSD 磁盘。  
**解决方法** ：使用只包含高级 SSD、标准 SSD 和/或标准 HDD 托管磁盘的源。

*\>必须从托管磁盘创建 <resourceID 的源虚拟机。*  
**原因** ： <resourceID 中的虚拟机 \> 使用非托管磁盘。  
**解决方法** ：根据仅包含高级 SSD、标准 SSD 和/或标准 HDD 托管磁盘的 VM 使用源。

*对源 "<resourceID" 的请求太多 \> 。请减少源上的请求数，或等待一段时间，然后重试。*  
**原因** ：由于请求过多，当前正在阻止此映像版本的源。  
**解决方法** ：稍后尝试创建映像版本。

*磁盘加密集 "<diskEncryptionSetID \> " 必须与库资源位于同一订阅 "<subscriptionID \> "。*  
**原因** ：磁盘加密集只能在创建它们的同一订阅和区域中使用。  
**解决方法** ：在与映像版本相同的订阅和区域中创建或使用加密集。

*加密源： "<resourceID \> " 与当前库映像版本订阅 "<subscriptionID 1" 的订阅 ID 不同 \_ \> 。请使用未加密的源 () 重试，或使用源的订阅 "<subcriptionID \_ 2 \> " 创建库映像版本。*  
**原因** ：如果对源图像进行了加密，则共享映像库当前不支持在其他源映像中创建其他订阅中的映像版本。  
**解决方法** ：使用未加密的源，或在与源相同的订阅中创建映像版本。

*找不到 <diskEncryptionSetID 的磁盘加密集 \> 。*  
**原因** ：磁盘加密可能不正确。  
**解决方法** ：检查磁盘加密集的资源 ID 是否正确。

*映像版本名称无效。映像版本名称应遵循主要 (int) 。次 (int) 。修补 (int) 格式，例如：1.0.0、2018.12.1 等。*  
**原因** ：图像版本的有效格式为以句点分隔的三个整数。 映像版本名称不符合有效的格式。  
**解决方法** ：使用格式主要 (int) 的映像版本名称。次 (int) 。修补 (int) 。 例如：1.0.0。 或2018.12.1。

*参数 galleryArtifactVersion 的值无效。 publishingProfile. diskEncryptionSetId 的值无效*  
**原因** ：数据磁盘映像上使用的磁盘加密集的资源 ID 使用的格式无效。  
**解决方法** ：请确保磁盘加密集的资源 ID 遵循格式/Subscriptions/<subscriptionID \> /ResourceGroups/<ResourceGroupName \> /providers/Microsoft.Compute/<diskEncryptionSetName \> 。

*参数 galleryArtifactVersion 的值无效。 osDiskImage. publishingProfile. diskEncryptionSetId。*  
**原因** ：操作系统磁盘映像上使用的磁盘加密集的资源 ID 使用的格式无效。  
**解决方法** ：请确保磁盘加密集的资源 ID 遵循格式/Subscriptions/<subscriptionID \> /ResourceGroups/<ResourceGroupName \> /providers/Microsoft.Compute/<diskEncryptionSetName \> 。

*无法 \> 使用区域 [<区域] 中的磁盘加密集来指定新的数据磁盘映像加密 lun [<号] \> ，以更新库映像版本请求。若要更新此版本，请删除新的 lun。如果需要更改数据磁盘映像加密设置，则必须使用正确的设置创建新的库映像版本。*  
**原因** ：向现有映像版本的数据磁盘添加加密。 不能向现有映像版本添加加密。  
**解决方法** ：创建新的库映像版本或删除添加的加密设置。

*库项目版本源只能在 storageProfile 下或者在单独的 OS 或数据磁盘中直接指定。可以提供一个且仅有一个源类型 (用户映像、快照、磁盘、虚拟机) 。*  
**原因** ：缺少源 ID。  
**解决方法** ：确保源的源 ID 存在。

*找不到源： <resourceID \> 。请确保源存在。*  
**原因** ：源的资源 ID 可能不正确。  
**解决方法** ：确保源的资源 ID 正确。

*目标区域 "<区域 1" 中的磁盘 "galleryArtifactVersion" 需要磁盘加密集， \_ \> 因为磁盘加密集 "<diskEncryptionSetId \> " 用于区域 "<区域 \_ 2" 中的相应磁盘。 \>*  
**原因** ：加密已在 <区域2中的 OS 磁盘上 \_ 使用 \> ，但在 <区域1中不存在 \_ \> 。  
**解决方法** ：如果在 OS 磁盘上使用加密，请在所有区域中使用加密。

*目标区域 "<区域 1" 中的磁盘 "LUN <编号" 需要磁盘加密集， \> \_ \> 因为磁盘加密设置 "<diskEncryptionSetID \> " 用于区域 "<区域 \_ 2" 中的相应磁盘 \>*  
**原因** ：加密已在 <区域2的 LUN <号的数据磁盘上使用 \> \_ \> ，但在 <区域1中不存在 \_ \> 。  
**解决方法** ：如果在数据磁盘上使用加密，请在所有区域中使用加密。

*DataDiskImages 中指定的 lun [<号 \> ] 无效。Lun 必须为以下值之一： ["0，9"]。*  
**原因** ：为加密指定的 lun 与附加到 VM 的磁盘的任何 lun 都不匹配。  
**解决方法** ：将加密中的 lun 更改为 VM 中存在的数据磁盘的 lun。

*\>在目标区域 "<区域" dataDiskImages 中指定了重复的 lun "<号" \> 。*  
**原因** ： <区域中使用的加密设置 \> 至少指定了一个 LUN 两次。  
**解决方法** ：更改 <区域中的 lun \> ，以确保所有 lun 在 <区域中是唯一的 \> 。

*OSDiskImage 和 DataDiskImage 不能指向同一 blob <sourceID\>*  
**原因** ：操作系统磁盘和至少一个数据磁盘的源不唯一。  
**解决方法** ：更改 os 磁盘和/或数据磁盘的源，以确保操作系统磁盘以及每个数据磁盘都是唯一的。

*目标发布区域中不允许出现重复区域。*  
**原因** ：区域在发布区域中多次列出。  
**解决方法** ：删除重复的区域。

*不允许在现有映像中添加新的数据磁盘或更改数据磁盘的 LUN。*  
**原因** ：对映像版本的更新调用中包含新的数据磁盘，或磁盘有新的 LUN。  
**解决方法** ：使用现有映像版本的 lun 和数据磁盘。

*<diskEncryptionSetID 的磁盘加密集 \> 必须位于与库资源 <subscriptionID 相同的订阅中 \> 。*  
**原因** ：共享映像库当前不支持使用其他订阅中的磁盘加密集。  
**解决方法** ：在同一订阅中创建映像版本和磁盘加密集。

## <a name="creating-or-updating-a-vm-or-scale-sets-from-an-image-version"></a>从映像版本创建或更新 VM 或规模集 ##

*客户端有权在 <resourceID 的作用域上执行操作 "Microsoft. 计算/库/映像/版本/读取" \> ，但当前租户 <tenantId1 无权 \> 访问链接的订阅 <subscriptionId2 \> 。*  
**原因** ：虚拟机或规模集是通过另一个租户中的 SIG 映像创建的。 你已尝试对虚拟机或规模集进行更改，但无权访问拥有该映像的订阅。  
**解决方法** ：与映像版本订阅的所有者联系，以授予对映像版本的读取访问权限。

*<resourceID 的库图像 \> 在 <区域区域中不可用 \> 。请联系映像所有者以复制到此区域，或更改请求的区域。*  
**原因** ：正在创建 VM 的区域不在库图像的已发布区域列表中。  
**解决方法** ：将映像复制到区域，或在库映像的发布区域的其中一个区域中创建 VM。

*不允许使用参数 ' osProfile '。*  
**原因** ：为从专用映像版本创建的 VM 提供了管理员用户名、密码或 SSH 密钥。  
**解决方法** ：如果想要从该映像创建 VM，请勿包含管理员用户名、密码或 SSH 密钥。 否则，请使用通用化映像版本，并提供管理员用户名、密码或 SSH 密钥。

*缺少必需的参数 "osProfile" (null) 。*  
**原因** ： VM 是通过一般化映像创建的，缺少管理员用户名、密码或 SSH 密钥。 由于通用化映像不会保留管理员用户名、密码或 SSH 密钥，因此，在创建 VM 或规模集的过程中，必须指定这些字段。  
**解决方法** ：指定管理员用户名、密码或 SSH 密钥，或使用专用映像版本。

*无法从以下项创建库映像版本： <resourceID， \> 因为父库映像中的 OS 状态 ( "专用" ) 不是 "通用化"。*  
**原因** ：映像版本是从通用源创建的，但其父定义是专用的。  
**解决方法** ：可以使用专用源创建映像版本，也可以使用通用化的父定义。

*无法将虚拟机规模集 <vmssName 更新为虚拟机 \> 规模集的当前 OS 状态，这不同于专用化的已更新库映像操作系统状态。*  
**原因** ：规模集的当前源映像是通用源映像，但使用专用的源映像进行更新。 规模集的当前源映像和新的源映像必须处于相同状态。  
**解决方法** ：若要更新规模集，请使用通用化映像版本。

*\><versionId \> 属于订阅 <subscriptionId1 \> ，且不能与订阅 <subscriptionId2 中的资源 "" 一起使用，则将磁盘加密设置 <共享映像库中的 diskEncryptionSetId。\>*  
**原因** ：用于对映像版本进行加密的磁盘加密集驻留在与用于承载映像版本的订阅不同的订阅中。  
**解决方法** ：对映像版本和磁盘加密集使用相同的订阅。

创建 VM 或虚拟机规模集需要很长的时间。  
**解决方法** ：验证你尝试从其创建 VM 或虚拟机规模集的映像版本的 **OSType** 与用于创建映像版本的源的 **OSType** 相同。 

## <a name="creating-a-disk-from-an-image-version"></a>从映像版本创建磁盘 ##

*参数 imageReference 的值无效。*  
**原因** ：你已尝试从 SIG 映像版本导出到磁盘，但使用映像中不存在的 LUN 位置。    
**解决方法** ：检查映像版本，查看正在使用的 LUN 位置。

## <a name="sharing-resources"></a>共享资源

使用 [AZURE RBAC)  (使用 azure 基于角色的访问控制 ](../role-based-access-control/rbac-and-directory-admin-roles.md)来启用跨订阅共享映像库、映像定义和映像版本资源。 

## <a name="replication-speed"></a>复制速度

使用 **--Expand ReplicationStatus** 标志来检查到所有指定目标区域的复制是否已完成。 如果没有，请等待最多六个小时才能完成作业。 如果失败，请再次触发用于创建并复制映像版本的命令。 如果正在将映像版本复制到多个目标区域，请考虑分阶段执行复制。

## <a name="azure-limits-and-quotas"></a>Azure 限制和配额 

[Azure 限制和配额](../azure-resource-manager/management/azure-subscription-service-limits.md)适用于所有共享映像库、映像定义和映像版本资源。 请确保你已在订阅限制范围内。 


## <a name="next-steps"></a>后续步骤

详细了解[共享映像库](./linux/shared-image-galleries.md)。